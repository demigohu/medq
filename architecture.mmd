graph LR
  subgraph Frontend
    A["Next.js 16 App<br/>App Router · TanStack Query · Zustand"]
    W["Wagmi + Reown AppKit<br/>Hedera Testnet (chain 296)"]
    C["Client Cache<br/>Zustand / cookies"]
  end

  subgraph Backend
    B["Express API<br/>/ai, /quests, /submit-proof"]
    S["Supabase Postgres<br/>quests, submissions, stats, leaderboard"]
    J["Cron & AI Jobs<br/>Groq, Pinata, daily/weekly quests"]
  end

  subgraph Hedera
    M["Hedera Mirror Node<br/>tx verification"]
    QM["QuestManager.sol<br/>ERC-8004 orchestrator"]
    RV["RewardVault.sol<br/>MEDQ ERC-20"]
    BN["BadgeNFT.sol<br/>ERC-721 rewards"]
    REG["ERC-8004 Registries<br/>Agent, Reputation, Validation, Identity"]
  end

  W -->|sign tx| QM
  A -->|REST quests/stats| B
  B -->|responses| A
  B -->|metadata + XP| S
  S -->|leaderboard + quests| A
  C --> A

  J -->|quest drafts + Pinata uploads| B
  J -->|daily/weekly quests| S

  B -->|verify tx hash| M
  B -->|recordCompletion oracle| QM
  QM -->|release MEDQ| RV
  QM -->|mint badge| BN
  QM -->|submit reputation| REG

